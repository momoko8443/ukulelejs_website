/*! ukulelejs 2015-11-19 */
!function(){function a(a,c,h,i){for(var j=[b,d,e,f,g],k=0;k<j.length;k++){var l=j[k],m=l.apply(this,arguments);if(m)break}}function b(a,b,d,e){var f=a.tagName;if("INPUT"===f&&c(a)&&"value"===b){var g="change",h=a.getAttribute("type");return"text"===h&&(g="input"),a.addEventListener(g,function(c){var f=a.getAttribute("uku-"+b);f=r.getFinalAttribute(f);for(var g=f.split("."),h=d.controllerInstance,i=0;i<g.length-1;i++)h=h[g[i]];h[g[g.length-1]]=a.value,e&&e(d.alias,a)}),!0}return!1}function c(a){var b=a.getAttribute("type");return"checkbox"!==b&&"radio"!==b?!0:!1}function d(a,b,c,d){var e=a.tagName;return"TEXTAREA"===e&&"value"===b?(a.addEventListener("input",function(e){var f=a.getAttribute("uku-"+b);f=r.getFinalAttribute(f);for(var g=f.split("."),h=c.controllerInstance,i=0;i<g.length-1;i++)h=h[g[i]];h[g[g.length-1]]=a.value,d&&d(c.alias,a)}),!0):!1}function e(a,b,c,d){var e=a.tagName;return"SELECT"===e&&"selected"===b?(a.addEventListener("change",function(e){var f,g=a.getAttribute("uku-"+b),h=g.split("|");g=h[0],f=h[1],g=r.getFinalAttribute(g);for(var i=g.split("."),j=c.controllerInstance,k=0;k<i.length-1;k++)j=j[i[k]];for(var l=a.querySelectorAll("option"),m=0;m<l.length;m++){var n=l[m];if(n.selected){var o=JSON.parse(n.getAttribute("data-item"));j[i[i.length-1]]=o}}d&&d(c.alias,a)}),!0):!1}function f(a,b,c,d){var e=a.tagName;return"INPUT"===e&&"value"===b&&"checkbox"===a.getAttribute("type")?(a.addEventListener("change",function(e){var f=a.getAttribute("uku-"+b);f=r.getFinalAttribute(f);for(var g=f.split("."),h=c.controllerInstance,i=0;i<g.length-1;i++)h=h[g[i]];h[g[g.length-1]]=a.checked,d&&d(c.alias,a)}),!0):!1}function g(a,b,c,d){var e=a.tagName;return"INPUT"===e&&"selected"===b&&"radio"===a.getAttribute("type")?(a.addEventListener("change",function(e){var f=a.getAttribute("uku-"+b);f=r.getFinalAttribute(f);for(var g=f.split("."),h=c.controllerInstance,i=0;i<g.length-1;i++)h=h[g[i]];a.checked&&(h[g[g.length-1]]=a.value,d&&d(c.alias,a))}),!0):!1}function h(){"use strict";function b(a,b){function c(a){var c=l[a];if(!c)return void(t.parentUku&&t.parentUku.refresh(a));for(var e=c.controllerInstance,f=s[a],g=0;g<c.boundItems.length;g++){var h=c.boundItems[g],i=h.attributeName;if(f){"selected"===h.ukuTag&&(i=i.split("|")[0]);var j=r.getFinalValue(t,e,i),k=r.getFinalValue(t,f,i);if(!q.compare(k,j)){i=h.attributeName;for(var m=c.getBoundItemsByName(i),n=0;n<m.length;n++){var o=m[n];o.element!==b&&o.render(e)}t.refreshHandler&&t.refreshHandler.call(t)}}}d(e,a)}if(a){if("string"==typeof a)c(a);else if(q.isArray(a))for(var e=0;e<a.length;e++)c(a[e])}else for(var f in l)c(f)}function c(){for(var a in l){var b=l[a],c=b.controllerInstance;d(c,a)}}function d(a,b){var c=q.deepClone(a);delete s[b],s[b]=c}function e(e){function h(a,b){function c(a){function e(a,b){var c=a.getAttribute("uku-onload");c&&(b?g(c,[b]):g(c,[a]))}function f(a,b){var c=b.split("|");if(c&&2===c.length){var d=c[0],e=c[1];return a=a.replace(new RegExp(d,"gm"),e)}return a}var j=d[a],k=j.getAttribute("load");if("false"===k)a++,a<d.length?c(a):b();else{var l=j.getAttribute("src"),m=j.getAttribute("replace"),n=j.getAttribute("replace-controller"),o=new i;m&&"true"===m?!function(g){o.get(l,function(i){n&&(i=f(i,n)),g.insertAdjacentHTML("beforeBegin",i);var j=g.previousElementSibling;g.parentNode.removeChild(g),w.push({func:e,args:[g,j]}),h(j,function(){a++,a<d.length?c(a):b()})})}(j):!function(g){o.get(l,function(i){n&&(i=f(i,n)),g.insertAdjacentHTML("afterBegin",i),g.classList.remove("uku-include"),w.push({func:e,args:[g]}),h(g,function(){a++,a<d.length?c(a):b()})})}(j)}}var d=a.querySelectorAll(".uku-include"),e=0;e<d.length?c(e):b()}function l(a){-1!==r.searchUkuExpTag(j.directText(a))&&(r.isRepeat(a)||r.isInRepeat(a)||p(a));for(var b=0;b<a.children.length;b++)l(a.children[b])}function p(a){var b=j.directText(a);if(-1!==r.searchUkuExpTag(b)){var c=b.slice(2,-2),d=f(c);if(d){var e=new m(c,b,a,t);d.addBoundItem(e),e.render(d.controllerInstance)}}}function q(c,d){var e=c.getAttribute("uku-"+d),g=(c.tagName,f(e));if(g){var h=new k(e,d,c,t);g.addBoundItem(h),h.render(g.controllerInstance),a(c,d,g,b)}}function s(a){var b=a.getAttribute("uku-text");if(b){var c=f(b);if(c){var d=new n(b,a,t);c.addBoundItem(d),d.render(c.controllerInstance)}}}function u(a,c){var e=a.getAttribute("uku-"+c),h=c.substring(2),i=f(e);if(i){var j,k=i.controllerInstance,l=e.split(".");j="parent"===l[0]?l[1]:l[0],a.addEventListener(h,function(c){d(k,j),g(e,arguments),b(j,a)})}}function v(a){var b=a.getAttribute("uku-repeat"),c=b.split(" in "),d=c[0],e=c[1],g=f(e);if(g){var h=g.controllerInstance,i=new o(e,d,a,t);g.addBoundItem(i),i.render(h)}}var w=[];h(e,function(){function a(a){for(var b=[],c=0;c<a.attributes.length;c++){var d=a.attributes[c];-1!==d.nodeName.search("uku-on")?b.push(d):b.unshift(d)}return b}var b=[],d=j.fuzzyFind(e,"uku-");d&&b.push(d);for(var f=e.querySelectorAll("*"),g=0;g<f.length;g++){var h=f[g],i=j.fuzzyFind(h,"uku-");i&&!r.isInRepeat(i)&&b.push(i)}l(e);for(var k=0;k<b.length;k++)for(var m=b[k],n=a(m),o=0;o<n.length;o++){var p=n[o];if(r.searchUkuAttrTag(p.nodeName)>-1){var x=p.nodeName.split("-");x.shift();var y=x.join("-");"application"!==y&&(0===y.search("on")?r.isRepeat(m)||r.isInRepeat(m)||u(m,y):-1!==y.search("repeat")?v(m):r.isRepeat(m)||r.isInRepeat(m)||("text"!==y?q(m,y):s(m)))}}for(c();w.length>0;){var z=w.pop();z.func.apply(this,z.args)}t.refreshHandler&&t.refreshHandler.call(t),t.initHandler&&t.initHandler.call(t,e)})}function f(a){var b=r.getBoundModelInstantName(a),c=l[b];if(!c){var d=a.split("."),e=d[0];if("parent"===e&&t.parentUku)return d.shift(),a=d.join("."),t.parentUku.getControllerModelByName(a)}return c}function g(a,b){var c=f(a),d=c.controllerInstance,e=r.getFinalValue(t,d,a,b);return e}function h(){var a=document.querySelectorAll("[uku-application]");if(1!==a.length)throw new Error("Only one 'uku-application' can be declared in a whole html.");e(a[0])}var l={},s={},t=this;this.refreshHandler=null,this.initHandler=null,this.parentUku=null,this.init=function(){h()},this.registerController=function(a,b){var c=new p(a,b);l[a]=c},this.dealWithElement=function(a){e(a)},this.loadIncludeElement=function(a){"false"===a.getAttribute("load")&&(a.setAttribute("load",!0),e(a.parentNode))},this.getControllerModelByName=function(a){return f(a)},this.refresh=function(a){b(a)},this.getFinalValueByExpression=function(a){var b=this.getControllerModelByName(a).controllerInstance;return r.getFinalValue(this,b,a)},this.watch=function(c,d){var e=f(c);if(e){var g=new k(attr,tagName,element,t);e.addBoundItem(g),g.render(e.controllerInstance),a(element,tagName,e,b)}},this.unwatch=function(a,b){}}function i(){}function j(){}function k(a,b,c,d){l.call(this,a,c,d),this.ukuTag=b}function l(a,b,c){"use strict";this.attributeName=a,this.element=b,this.uku=c}function m(a,b,c,d){l.call(this,a,c,d),this.expression=b}function n(a,b,c){l.call(this,a,b,c),this.tagName="text"}function o(a,b,c,d){l.call(this,a,c,d),this.expression=b,this.renderTemplate=c.outerHTML,this.parentElement=c.parentNode,this.beginCommentString=void 0,this.endCommentString=void 0}function p(a,b){"use strict";this.alias=a,this.controllerInstance=b,this.boundItems=[]}function q(){}function r(){"use strict"}"function"==typeof define&&define.amd?define("Ukulele",[],function(){return h}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports.Ukulele=h):window.Ukulele=h,i.prototype.get=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){4===d.readyState&&(200===d.status?b(d.responseText):c&&c())},d.open("GET",a,!0),d.send(null)},j.fuzzyFind=function(a,b){if(a&&a.attributes)for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];if(d.nodeName.search(b)>-1)return a}return null},j.directText=function(a,b){for(var c="",d=a.childNodes,e=0;e<=d.length-1;e++){var f=d[e];if(3===f.nodeType){if(b||""===b||0===b||b===!1)return void(f.nodeValue=b);c+=f.nodeValue}}return c.trim()},j.parents=function(a){for(var b=[];a.parentNode&&"BODY"!==a.parentNode.tagName;)b.push(a.parentNode),a=a.parentNode;return b},k.prototype=new l,k.prototype.constructor=k,k.prototype.render=function(a){var b,c=this.attributeName,d=this.element.tagName;if("selected"===this.ukuTag&&"SELECT"===d){var e=this.attributeName.split("|");c=e[0],b=e[1]}var f=r.getFinalValue(this.uku,a,c);if(-1!==this.ukuTag.search("data-item"))f=JSON.stringify(f),this.element.setAttribute("data-item",f);else if("selected"===this.ukuTag&&"SELECT"===d){var g;g=b?f[b]:f,this.element.value=g}else"checkbox"===this.element.getAttribute("type")?this.element.checked=f:"value"===this.ukuTag?this.element.value=f:"radio"===this.element.getAttribute("type")?this.element.value===f&&this.element.setAttribute("checked",!0):"IMG"===this.element.nodeName&&"src"===this.ukuTag?f&&this.element.setAttribute(this.ukuTag,f):"disabled"===this.ukuTag?this.element.disabled=f:this.element.setAttribute(this.ukuTag,f)},m.prototype=new l,m.prototype.constructor=m,m.prototype.render=function(a){var b=r.getFinalValue(this.uku,a,this.attributeName);j.directText(this.element,b)},n.prototype=new l,n.prototype.constructor=n,n.prototype.render=function(a){var b=r.getFinalValue(this.uku,a,this.attributeName);this.element.innerHTML=b},o.prototype=new l,o.prototype.constructor=o,o.prototype.render=function(a){function b(a){return a.nodeValue===e.beginCommentString?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}function c(){var a=r.searchHtmlTag(e.renderTemplate,"tr");return-1===a?document.createElement("div"):document.createElement("tbody")}var d=r.getFinalValue(this.uku,a,this.attributeName);if(d){var e=this;if(this.element&&this.element.parentNode){this.beginCommentString="begin uku-repeat: "+this.expression+" in "+this.attributeName;var f=document.createComment(this.beginCommentString);this.element.parentNode.insertBefore(f,this.element),this.endCommentString="end uku-repeat: "+this.expression+" in "+this.attributeName;var g=document.createComment(this.endCommentString);this.element.parentNode.insertBefore(g,this.element.nextSibling),this.element.parentNode.removeChild(this.element)}for(var i=document.createTreeWalker(this.parentElement,NodeFilter.SHOW_COMMENT,b,!1);i.nextNode();){var j=i.currentNode;if(j&&j.nodeValue===this.beginCommentString){for(;j.nextSibling&&j.nextSibling.nodeValue!==this.endCommentString;)j.parentNode.removeChild(j.nextSibling);var k=c(),l=c();j.parentNode.insertBefore(l,j.nextSibling);for(var m=0;m<d.length;m++)if(k.insertAdjacentHTML("beforeEnd",this.renderTemplate),m===d.length-1){var n=k.innerHTML;l.insertAdjacentHTML("beforeBegin",n),j.parentNode.removeChild(l),k=null,l=null}for(var o=j.nextSibling,p=0;p<d.length;p++){o.removeAttribute("uku-repeat");var q=new h;q.parentUku=this.uku,q.registerController(this.expression,d[p]),q.dealWithElement(o),o=o.nextSibling}}}if("OPTION"===this.element.tagName){var s=this.parentElement.getAttribute("uku-selected"),t=s.split("|");s=t[0],key=t[1];var u=this.uku.getFinalValueByExpression(s);key?this.parentElement.value=u[key]:this.parentElement.value=u}}},p.prototype.addBoundItem=function(a){this.boundItems.push(a)},p.prototype.getBoundItemsByName=function(a){for(var b=[],c=0;c<this.boundItems.length;c++){var d=this.boundItems[c];d.attributeName===a&&b.push(d)}return b};var s={};Object.hasOwnProperty("observe")||(Object.hasOwnProperty("defineProperty")?Object.observe=function(a,b){for(var c in a){var d=a[c];a["_"+c]=a[c],a.hasOwnProperty(c)&&(!function(b,c){Object.defineProperty(a,"_"+c,{writable:!1})}(a,c),function(c,d,e){Object.defineProperty(a,d,{get:function(){return a["_"+d]},set:function(a){this["_"+d]=a;var c={name:d,object:this,type:"update",oldValue:e};b.call(null,[c])}})}(a,c,d))}s[s]=!0}:console.error("Current browser can't support this site.")),Object.hasOwnProperty("unobserve")||(Object.hasOwnProperty("defineProperty")?Object.unobserve=function(a,b){if(s[a]){for(var c in a)a.hasOwnProperty(c)&&-1===c.search("_")&&(delete a[c],a[c]=a["_"+c],delete a["_"+c]);delete s[a],b()}}:console.error("Current browser can't support this site.")),q.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},q.getType=function(a){var b=typeof a;return"object"===b&&q.isArray(a)?"array":b},q.compare=function(a,b){var c=q.getType(a),d=q.getType(b),e=!0;if(c!==d)return!1;switch(c){case"object":for(var f in a){var g=a[f],h=b[f],i=q.compare(g,h);if(!i){e=!1;break}}break;case"array":if(a.length===b.length)for(var j=0;j<a.length;j++){var k=a[j],l=b[j],m=q.compare(k,l);if(!m){e=!1;break}}else e=!1;break;case"function":e=a.toString()===b.toString();break;default:e=a===b}return e},q.deepClone=function(a){var b,c,d;if("object"!=typeof a||null===a)return a;if(a instanceof Array)for(b=[],c=0,d=a.length;d>c;c++)"object"==typeof a[c]&&null!==a[c]?b[c]=arguments.callee(a[c]):b[c]=a[c];else{b={};for(c in a)"object"==typeof a[c]&&null!==a[c]?b[c]=arguments.callee(a[c]):b[c]=a[c]}return b},r.getFinalAttribute=function(a){var b=a.split("."),c=b.shift();return"parent"===c?r.getFinalAttribute(b.join(".")):b.join(".")},r.searchHtmlTag=function(a,b){var c="^<"+b+"\\s[\\s\\S]*</"+b+">$",d=new RegExp(c),e=a.search(d);return e},r.isStringArgument=function(a,b){var c=/^"[\s\S]*"$/,d=a.search(c),e=/^'[\s\S]*'$/;if(0===d)return!0;var f=a.search(e);return 0===f?!0:!1},r.searchUkuAttrTag=function(a){var b=/^uku\-.*/,c=a.search(b);return c},r.searchUkuExpTag=function(a){var b=/^\{\{.*\}\}$/,c=a.search(b);return c},r.searchUkuFuncArg=function(a){var b=/\(.*\)$/,c=a.search(b);return c},r.isRepeat=function(a){return a.getAttribute("uku-repeat")?!0:!1},r.isInRepeat=function(a){for(var b=j.parents(a),c=0;c<b.length;c++){var d=b[c],e=d.getAttribute("uku-repeat");if(e)return!0}return!1},r.getBoundModelInstantName=function(a){var b=a.split(".")[0];return b?b:null},r.getAttributeFinalValue=function(a,b){var c=r.getAttributeFinalValueAndParent(a,b),d=c.value;return d},r.getAttributeFinalValueAndParent=function(a,b){var c,d=a;b=r.getFinalAttribute(b);var e=b.split(".");if(""!==b&&d)for(var f=0;f<e.length;f++){var g=e[f];if(c=d,d=d[g],void 0===d||null===d)break}return{value:d,parent:c}},r.getFinalValue=function(a,b,c,d){var e=r.searchUkuFuncArg(c);if(-1===e)return r.getAttributeFinalValue(b,c);var f=c.substring(0,e),g=r.getAttributeFinalValueAndParent(b,f),h=g.value;if(void 0===h)return h;var i=[],j=c.substring(e+1,c.length-1);if(""!==j){var k=r.isStringArgument(j);j=k?[j]:j.split(",");for(var l=0;l<j.length;l++){var m,n=j[l],o=a.getControllerModelByName(n);if(o&&o.controllerInstance){var p=o.controllerInstance;m=1===n.split(".").length?p:r.getFinalValue(a,p,n)}else m=r.getFinalValue(a,b,n);if(m!==b)i.push(m);else{var q=/\'.*\'/,s=n.search(q),t=/\".*\"/,u=n.search(t);-1!==s?(n=n.substring(1,n.length-1),i.push(n)):-1!==u?(n=n.substring(1,n.length-1),i.push(n)):i.push(m)}}}if(d){var v=Array.prototype.slice.call(d);i=i.concat(v)}return h=h.apply(g.parent,i)}}();